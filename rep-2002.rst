REP: 2002
Title: ROS 2 Rolling Release
Author: Steven! Ragnarok <steven@openrobotics.org>
Status: Draft
Type: Informational
Content-Type: text/x-rst
Created: 05-Sep-2019
Post-History: 05-Sep-2019, 03-Oct-2019, 18-Oct-2019


Abstract
========

This REP describes a rolling ROS 2 distribution which will serve as the target for ongoing development of ROS 2.
It also describes how future releases of ROS 2 may be produced by taking a snapshot of the rolling distribution to produce the next fixed release of ROS 2. 


Motivation
==========

Create a rolling ROS distribution to serve as the foundation for subsequent stable ROS distributions in order to reduce the workload of Open Robotics staff and individual package maintainers when bootstrapping new ROS releases.


Support status
==============

The rolling release itself will not be considered a supported platform.
Distribution syncs will be performed on a regular cadence just like stable distributions but regressions may not block a rolling release sync.
During the pre-release phase for stable ROS distributions releases in the rolling distribution may be blocked or held back in order to conform to the support requirements of the upcoming stable release.


Release process
===============

Releasing stable ROS distributions from a rolling release
---------------------------------------------------------

When a new stable release is being prepared, the rolling release will be used as a staging ground to prepare that release.
Updates and new package releases made to the rolling release will be propagated automatically to the stable release.
At an announced time prior to the official stable release, the stable distribution will be created and packages with successful builds on the rolling release will be automatically released via bloom into the stable release.
Once the stable distribution has been created and the automatic bloom process has been run, changes to the rolling release may not be automatically propagated to the stable release although 


Updating the rolling release platforms
--------------------------------------

The rolling release is intended to remain availabe indefinitely and so will not be retired or reach end-of-support status without an update to this REP and the ROS distribution release process.
However, this does mean that platform changes during the life of the rolling distribution are going to occur and the rolling release may target platforms that are themselves unstable or in a pre-release state.
When a platform change is coming, the intended date of change will be announced ahead of time.
Once the platforms have been updated, everything currently in the rolling release will be automatically re-released via bloom to target the updated release platforms.


Bootstrapping the rolling release
---------------------------------

The first release of the rolling rosdistro will use the same procedure we've used for all stable rosdistros previously.
Packages will be released via bloom into an empty distribution until the distribution is relatively complete.
Package maintainers may then choose to make releases into the rolling rosdistro.


Recommendations for package maintainers
=======================================

Versioning between rolling and stable distributions
---------------------------------------------------

When a new stable release is created, the ROS core team strongly recommends that the next release made into the rolling release bump at least the minor version number.
For example if the version of a package in both the rolling and current stable distribution is ``1.2.3`` and there are new changes that are targeting the rolling distribution only, bump the version to at least ``1.3.0``.
This allows the patch release of the ``1.2.x`` series to be used for any future changes targeting only the stable distribution.
Even if no changes are planned it is still a good idea to leave room for unanticipated fixes.
The alternative is that version numbers may get confusing as the rolling distribution contains ``1.2.4`` but ``1.2.5`` is released only into the stable distribution as a fix on ``1.2.3``.


Implementation
==============


Changes to rosdistro distribution files
---------------------------------------

A new distribution_status semantic value of ``rolling`` will be added to the rosdistro index v4 format specified in REP-153 [1]_.
Rolling releases will be excluded from consideration in certain status pages (such as the blocked_releases_* pages) and considered differently from the active stable distributions.


Additions to ros_buildfarm and bloom
------------------------------------

The ros_buildfarm [2]_ and bloom [3]_ projects will both require changes to allow bloom to be run on a ROS build farm.
ros_buildfarm will require additional jobs that can re-run bloom unattended when the rolling release platforms change, or when dependencies that were previously unavailable have been made available.

Bloom may require some changes to allow it to be run unattended with pre-selected answers to interactive questions.


Managing build farm writable release repositories
-------------------------------------------------

In order to allow bloom to be run in an automated fashion the release repository must be writeable by the build farm agents.
Release repositories may be hosted in a standard location such as the ros-gbp or ros2-gbp organizations on GitHub.
If a repository isn't writeable by the build farm the release repository may be forked to a standard location for the purpose of making the release.
Some form of breadcrumb will be left so that the previous release repository is noted.



References
==========

.. [1] REP 153: ROS distribution files
   (http://www.ros.org/reps/rep-0153.html)

.. [2] ros_buildfarm repository
   (https://github.com/ros-infrastructure/ros_buildfarm)

.. [3] bloom repository
   (https://github.com/ros-infrastructure/bloom)

.. [4] Time for reviewing ROS distro release cycle on Discourse
   (https://discourse.ros.org/t/time-for-reviewing-ros-distro-release-cycle/2744/3)

.. [5] Proposed changes to the ROS releases discussion on Discourse
   (https://discourse.ros.org/t/proposed-changes-to-the-ros-releases/4736)


Copyright
=========

This document has been placed in the public domain.


..
   Local Variables:
   mode: indented-text
   indent-tabs-mode: nil
   sentence-end-double-space: t
   fill-column: 70
   coding: utf-8
   End:
