REP: 153
Title: ROS distribution files
Author: Dirk Thomas <dthomas@osrfoundation.org>
Status: Final
Type: Standards Track
Content-Type: text/x-rst
Created: 27-Oct-2018
Post-History: 27-Oct-2018


.. contents::

Abstract
========
This REP updates the specification of the ROS distribution files facilitated in
the building, packaging, testing and documenting process.

The intention is to annotate a ROS distribution with more information (like the
"major" version (``1`` or``2``) to avoid the need to externally define and
update these metadata.

This REP is an extension to the file format defined in REP 143[1]_.
It currently does not repeat the content of REP 143 but only states the
differences.


Motivation
==========

For the following use cases additional metadata is currently necessary:

A. The ROS buildfarm has to distinguish ROS 1 distributions from ROS 2
   distributions because they require different dependencies to build a
   workspace.
   E.g. for ROS 1 workspaces ``catkin`` needs to be installed - even
   for plain CMake packages - since it provides the workspace level setup
   files.
   For ROS 2 the package ``ros_workspace`` is needed since it provides the
   setup files for the workspace and therefore the environment necessary to
   find resources.

B. The ROS wiki shows the list of currently active ROS distributions.
   Since the ``rosdistro`` contains all ROS distros - EOLed ones as well as
   upcoming distributions before their release date.

In both cases the missing metadata is currently being hard coded in the source
code and needs to be updated with every new ROS release.
Therefore this REP aims to add the necessary metadata about a ROS distribution
into the ``rosdistro`` instead.


Specification
=============

Index file
----------

* distributions

  * distribution:

    * distribution_status: an optional string describing the status of a ROS
      distribution.
      For the use case *B.* the semantic of the following values is defined:

      * ``prerelease``: An upcoming distribution which hasn't been released yet
      * ``active``: A distribution which has been released and is actively
        being supported
      * ``end-of-life``: A distribution which has reached its end of life

    * distribution_type: an optional string describing the type of the ROS
      distribution.
      For use case *A.* the values ``ros1`` and ``ros2`` will be used to
      distinguish the major ROS version.

* version: version number, this REP describes version 4 (instead of version 3
  described in REP 143 [1]_, version 2 described in REP 141 [2]_ and version 1
  described in REP 137 [3]_)


Reference implementation
------------------------
This REP is to be implemented in version 0.7 of the Python package *rosdistro*.
It will serve as a reference implementation for this REP.
A draft implementation can be found in [4]_.


Compatibility issues
====================

The draft implementation of rosdistro is able to parse multiple index format
versions: 2, 3 as well as 4.

As soon as the new version of 'rosdistro' is released and the ROS 2
distributions have been moved from the forked repository into the
'ros/rosdistro' repository [5]_ the new field is being used to annotate the ROS
2 distributions.
Any client trying to access the data with an old 'rosdistro'
version will get an error message like this:

::

  Unable to handle 'index' format version '4', please update rosdistro...


References
==========
.. [1] REP 143: http://www.ros.org/reps/rep-0143.html
.. [2] REP 141: http://www.ros.org/reps/rep-0141.html
.. [3] REP 137: http://www.ros.org/reps/rep-0137.html
.. [4] Patch to python-rosdistro:
  https://github.com/ros-infrastructure/rosdistro/pull/124
.. [5] ROS distro: https://github.com/ros/rosdistro/


Copyright
=========
This document has been placed in the public domain.
